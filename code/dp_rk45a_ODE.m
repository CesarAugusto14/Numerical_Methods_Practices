function [t, x] = dp_rk45a_ODE(G, t0, tf, x0, mu, dt0)

    t(1) = t0; x(:,1) = x0; z(:,1) = x0;
    % TABLEAU:
    a1 = [1/5 1/5];
    a2 = [3/10  3/40   9/40];
    a3 = [4/5  44/45   -56/15 32/9];
    a4 = [8/9 19372/6561 -25360/2187 64448/6561 -212/729];
    a5 = [1 9017/3168 -355/33 46732/5247 49/176 -5103/18656];
    a6 = [1 35/384 0 500/1113 125/192 -2187/6784 11/84];
    e  = [5179/57600 0 7571/16695 393/640 -92097/339200 187/2100 1/40];

    dt = dt0;
    i = 1;
    while t(i) < tf
        k1 = dt*G(t(i), x(:, i));
        k2 = dt*G(t(i) + dt*a1(1), x(:, i) + k1*a1(2));
        k3 = dt*G(t(i) + dt*a2(1), x(:, i) + k1*a2(2) + k2*a2(3));
        k4 = dt*G(t(i) + dt*a3(1), x(:, i) + k1*a3(2) + k2*a3(3) + k3*a3(4));
        k5 = dt*G(t(i) + dt*a4(1), x(:, i) + k1*a4(2) + k2*a4(3) + k3*a4(4) + k4*a4(5));
        k6 = dt*G(t(i) + dt*a5(1), x(:, i) + k1*a5(2) + k2*a5(3) + k3*a5(4) + k4*a5(5) + k5*a5(6));
        k7 = dt*G(t(i) + dt*a6(1), x(:, i) + k1*a6(2) + k2*a6(3) + k3*a6(4) + k4*a6(5) + k5*a6(6) + k6*a6(7));
        z(:, i+1) = x(:, i) + k1*a6(2) + k2*a6(3) + k3*a6(4) + k4*a6(5) + k5*a6(6) + k6*a6(7); 
        x(:, i+1) = x(:, i) + k1*e(1) + k2*e(2) + k3*e(3) + k4*e(4) + k5*e(5) + k6*e(6) + k7*e(7);
        normzx = norm(-z(:, i+1) + x(:, i+1), 2);
        s = (mu*dt/normzx/2)^(1/4);
        dt = s*dt;
        t(i+1) = t(i) + dt; 
        i = i + 1;
    end
    x = x';
